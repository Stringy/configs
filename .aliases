#!/bin/bash

function _echo_and_run() {
    echo "[*]" $@
    eval $@
}

if [ -x "$(command -v gcloud)" ];
then
    echo "[*] installing gcp functions"
    #Â gcloud aliases
    function gcpssh() (
        PROJECT=$1
        HOST=$2
        shift;shift;
        _echo_and_run gcloud compute ssh $@ --project ${PROJECT} ${HOST}
    )

    function gcpscp() (
        PROJECT=$1
        FROM=$2
        TO=$3
        shift;shift;shift;
        _echo_and_run gcloud compute scp $@ --project ${PROJECT} ${FROM} ${TO}
    )
else
    echo "[*] gcloud not installed"
fi

alias vim="nvim"

function cdgo() {
    if [[ -z "${GOPATH}" ]]; then
        echo "[*] no GOPATH set"
        exit 1
    fi

    _echo_and_run cd "${GOPATH}/src/${1}"
}

function cdsrox() {
    _echo_and_run cdgo "github.com/stackrox/${1}"
}

function gcsource() {
    local name="$1"
    local config_file="$HOME/.gcloud-config/${name}"
    if [[ ! -e "${config_file}" ]]; then
        echo "[*] no gcloud config for ${name}"
        echo "[*] ${config_file} does not exist"
        return 1;
    fi
    _echo_and_run source "$HOME/.gcloud-config/${name}"
}

function gcreset() {
    gcsource reset
}
